{
    "old":{
        "start": {
            "032": {
                "flag": "old_heart_attack"
            },
            "031": {
                "flag": "old_show_stolen_heirloom"
            },
            "024": {
                "flag": "old_dd_mad"
            },
            "022": {
                "flag": "old_dd_reconciled"
            },
            "019": {
                "flag": "quest_flower_completed"
            },
            "014": {
                "flag": "quest_flower_accepted"
            },
            "013": {
                "flag": "quest_flower_refused"
            },
            "001": {}
        },
        "001": {
            "name": "Old Man",
            "text": "Oh, my beautiful Josefa, why did you have to leave me so soon?",
            "replies": {
                "002": {
                    "text": "Hi! Have you heard about a nearby vending machine? "
                },
                "004": {
                    "text": "What happened to your wife?"
                },
                "003": {
                    "text": "(Ignore)"
                }
            },
            "next": "003"
        },
        "002": {
            "name": "Old Man",
            "text": "Can't you see I'm mourning my wife? Don't bother me with that nonsense!"
        },
        "003": {
            "text": "He doesn't seem to notice you. Is he deep in thought... or is it just poor eyesight?"
        },
        "004": {
            "name": "Old Man",
            "text": "She was walking a boy's dog, and the wretched beast ran away. My wife went after it and a few hours later the dog came back, unharmed, while my wife was nowhere in sight.",
            "next": "005",
            "set_flag": "old_mention_dd"
        },
        "005": {
            "name": "Old Man",
            "text": "Later I found her, dead. The place was crawling with monsters, but I managed to bring back her body. She now rests dressed in her finest dress, with her beautiful family pendant at her neck.",
            "next": "006",
            "set_flag": "old_mention_necklace"
        },
        "006": {
            "name": "Old Man",
            "text": "May I ask something of you?",
            "replies": {
                "027": {
                    "text": "Hold on. Were you talking about this trinket?",
                    "item": "WifeHeirloom"
                },
                "009": {
                    "text": "Sure"
                    
                },
                "007": {
                    "text": "No"
                },
                "008": {
                    "text": "I don't care"
                }
            }
        },
        "007": {
            "name": "Old Man",
            "text": "It's alright.",
            "set_flag": "quest_flower_refused"
        },
        "008": {
            "name": "Old Man",
            "text": "How rude... Nevermind, then.",
            "set_flag": "quest_flower_refused"
        },
        "009": {
            "name": "Old Man",
            "text": "You seem like a capable individual. Would you mind picking up a certain flower for me?",
            "set_flag": "old_mention_flower",
            "replies": {
                "010": {
                    "text": "What's so special about this flower?",
                    "no_flag": "old_asked_special"
                },
                "011": {
                    "text": "Why don't you get it yourself?",
                    "no_flag": "old_asked_creatures"
                },
                "016": {
                    "text": "I already have it",
                    "item": "SpecialFlower"
                },
                "018": {
                    "text": "Actually, Dog Dude got one for you",
                    "flag": "dd_flower"                    
                },
                "012": {
                    "text": "Yeah, no problem"
                },
                "007": {
                    "text": "I can't"
                },
                "008":{
                    "text": "I don't care"
                }
            }
        },
        "010": {
            "name": "Old Man",
            "text": "It's my late wife's favorite flower. I'd like to place it in her grave...",
            "set_flag": "old_asked_special",
            "next": "009"
            
        },
        "011": {
            "name": "Old Man",
            "text": "I know where they grow, but the place's infested by vile creatures and I'm a frail, old man.",
            "set_flag": "old_asked_creatures",
            "next": "009"
        },
        "012": {
            "name": "Old Man",
            "text": "Oh, thank you so much. Josefa would be so pleased!",
            "set_flag": "quest_flower_accepted"
        },
        "013": {
            "name": "Old Man",
            "text": "Have you reconsidered?",
            "replies": {
                "009": {
                    "text": "Yes"
                },
                "002": {
                    "text": "Have you heard about a nearby vending machine?"
                },
                "004": {
                    "text": "Could you tell me about your wife again?"
                },
                "008": {
                    "text": "(Ignore)"
                    
                }
            }
        },
        "014": {
            "name": "Old Man",
            "text": "Do you have the flower?",
            "replies": {
                "017": {
                    "text": "Here you go",
                    "item": "SpecialFlower"
                },
                "018": {
                    "text": "Actually, Dog Dude got one for you",
                    "flag": "dd_flower"
                },
                "015": {
                    "text": "Not yet"
                }
            }
        },
        "015": {
            "name": "Old Man",
            "text": "Be safe, I won't go anywhere!"
        },
        "016": {
            "name": "Old Man",
            "text": "You've got it already?!",
            "next": "017"
        },
        "017": {
            "name": "Old Man",
            "text": "Thank you so much! You don't know how much this means to me... Here, this ain't much, but it's all I have!",
            "reward": "DogTreat",
            "set_flag":"quest_flower_completed",
            "remove_item":"SpecialFlower"
        },
        "018": {
            "name": "Old Man",
            "text": "Really? That's so nice of him! Maybe I've been too harsh... It wasn't his fault, and the dog's too stupid to blame",
            "delayed_flag":"old_dd_reconciled",
            "next": "017"
        },
        "019": {
            "name": "Old Man",
            "text": "Pleased to see you! How can I help?",
            "replies": {
                "027": {
                    "text": "Hey, is this your wife's pendant?",
                    "item": "WifeHeirloom"
                },
                "020": {
                    "text": "Have you heard about a machine nearby?"
                },
                "021": {
                    "text": "TODO"
                }
            }
        },
        "020": {
            "name": "Old Man",
            "text": "TODO: machine whereabouts"
        },
        "021": {
            "name": "Old Man",
            "text": "TODO: wife stuff"
        },
        "022": {
            "name": "Old Man",
            "text": "Thank you. I've been mad at him... Them, for too long. How can I help you?",
            "replies": {
                "027": {
                    "text": "Hey, is this your wife's pendant?",
                    "item": "WifeHeirloom"
                },
                "020": {
                    "text": "Have you heard about a machine nearby?"
                },
                "023": {
                    "text": "TODO: wife or reconciled question"
                }
            }
        },
        "023": {
            "name": "Old Man",
            "text": "Todo: wife or reconciled reply"
        },
        "024": {
            "name": "Old Man",
            "text": "That rotten bastard... And his beast... They will burn in hell!",
            "replies": {
                "030": {
                    "text": "Hey, is this your wife's pendant?",
                    "item": "WifeHeirloom"
                },
                "025": {
                    "text": "Have you heard about a machine nearby?"
                },
                "026": {
                    "text": "TODO: wife or mad question"
                }
            }
        },
        "025": {
            "name": "Old Man",
            "text": "Todo: pissed off machine reply"
        },
        "026": {
            "name": "Old Man",
            "text": "Todo: wife or mad reply"
        },
        "027": {
            "name": "Old Man",
            "text": "You... You monster. Give it to me, that's not yours to take!",
            "set_flag": "old_show_stolen_heirloom",
            "replies": {
                "028": {
                    "text": "I am so sorry, here you go"
                },
                "029": {
                    "text": "Nope, it's mine now"
                }
            }
        },
        "028": {
            "name": "Old Man",
            "text": "My poor Josefa's rest disturbed... I will never forgive you, begone!",
            "remove_item": "WifeHeirloom"
        },
        "029": {
            "name": "Old Man",
            "text": "No! I won't let y... My heart... I can't..... (dies)",
            "set_flag": "old_heart_attack"
        },
        "030": {
            "name": "Old Man",
            "text": "What?! And you made me blame it all on poor Dog Dude?!",
            "delayed_flag": "old_dd_reconciled",
            "next": "27"
        },
        "031": {
            "name": "Old Man",
            "text": "Begone! I don't want to see you again!"
        },
        "032": {
            "text": "He isn't moving... nor breathing."
        }
    },
    "dd": {
        "start": {
            "038": {
                "flag": "dd_return_dog"
            },
            "035": {
                "flag": "dd_borrow_dog"
            },
            "026": {
                "flag": "dd_flower"
            },
            "025": {
                "flag": "quest_flower_dd_sad"
            },
            "020": {
                "flag": "quest_flower_dd"
            },
            "018": {
                "flag": "quest_flower_dd_no"
            },
            "007": {
                "flag": "dd_mangy"
            },
            "006": {
                "flag": "dd_meet"
            },
            "001": {}
        },
        "001": {
            "name": "Dog Dude",
            "text": "Hey, I'm Dog Dude, and this is my lovely dog, Spritz.",
            "set_flag": "dd_meet",
            "replies": {
                "011": {
                    "text": "Hey, isn't that the dog who killed the old man's wife?",
                    "flag": "old_mention_dd"
                },
                "003": {
                    "text": "Hi, pleased to meet you"
                },
                "002": {
                    "text": "Get that mangy thing away from me"
                },
                "branch_dog": {
                    "text": "Could I borrow your dog?"
                }
            }
        },
        "002": {
            "name": "Dog Dude",
            "text": "Spritz ain't mangy!",
            "set_flag": "dd_mangy"
        },
        "003": {
            "name": "Dog Dude",
            "text": "Have you talked to Old Man Arnaldo?",
            "replies": {
                "010": {
                    "text": "Yes"
                },
                "005": {
                    "text": "No"
                },
                "004": {
                    "text": "Who?"
                },
                "008": {
                    "text": "Could I borrow that dog?",
                    "flag": "dd_mangy"
                },
                "branch_dog": {
                    "text": "Could I borrow Spritz?",
                    "no_flag": "dd_mangy"
                }
            }
        },
        "004": {
            "name": "Dog Dude",
            "text": "You don't know Old Man Arnaldo? He's that old man, down there.",
            "next": "005"
        },
        "005": {
            "name": "Dog Dude",
            "text": "If he asks something of you, please come and see me."
        },
        "006": {
            "name": "Dog Dude",
            "text": "Hello, again!",
            "next": "003"
        },
        "007": {
            "name": "Dog Dude",
            "text": "I hope you didn't come here to insult Spritz again...",
            "next": "003"
        },
        "008": {
            "name": "Dog Dude",
            "text": "It depends. Do you still think Spritz is a \"mangy thing\"?",
            "replies": {
                "009": {
                    "text": "Yes"
                },
                "branch_dog": {
                    "text": "No"
                }
            }
        },
        "009": {
            "name": "Dog Dude",
            "text": "Then I guess you wouldn't want that \"mangy thing\" following you around, would you?"
        },
        "010": {
            "name": "Dog Dude",
            "text": "What did he tell you?",
            "replies": {
                "011": {
                    "text": "He told me a dog got his wife killed.",
                    "flag": "old_mention_dd",
                    "no_flag": "dd_mention_spritz_fault"
                },
                "012": {
                    "text": "He wants me to get him some sort of flower.",
                    "flag": "old_mention_flower",
                    "no_flag": "old_asked_special"
                },
                "013": {
                    "text": "He wants me to get him his wife's favorite flower.",
                    "flag": "old_asked_special"
                },
                "005": {
                    "text": "Nothing interesting."
                }
            }
        },
        "011": {
            "name": "Dog Dude",
            "text": "It was not Spritz's fault. He only goes where people walk him, unless he's in danger. He came running back for help that day. Josefa probably didn't know of the monsters...",
            "set_flag": "dd_mention_spritz_fault",
            "next": "010"
        },
        "012": {
            "name": "Dog Dude",
            "text": "He was probably talking about his wife's favorite flower...",
            "next": "013"
        },
        "013": {
            "name": "Dog Dude",
            "text": "If I gave it to him, he might be willing to to hear me out and who knows, maybe forgive me...",
            "set_flag": "dd_know_quest_flower",
            "next": "014"
        },
        "014": {
            "name": "Dog Dude",
            "text": "When you find it, could you bring it to me instead? I would be forever grateful!",
            "replies": {
                "023": {
                    "text": "I already have it. Here you go",
                    "item": "SpecialFlower"
                },
                "022": {
                    "text": "I've already given it to Arnaldo",
                    "flag": "quest_flower_completed",
                    "no_flag": "dd_flower"
                },
                "015": {
                    "text": "Sure"
                },
                "016": {
                    "text": "No"
                },
                "017": {
                    "text": "I'm not going to get the flower"
                }
            }
        },
        "015": {
            "name": "Dog Dude",
            "text": "Thank you. Spritz and I will be here, friend!",
            "set_flag": "quest_flower_dd"
        },
        "016": {
            "name": "Dog Dude",
            "text": "Oh... That's a shame. At least you'll help Arnaldo.",
            "set_flag": "quest_flower_dd_no"
        },
        "017": {
            "name": "Dog Dude",
            "text": "I think you should reconsider. I'll be here if you do.",
            "set_flag": "quest_flower_dd_no"
        },
        "018": {
            "name": "Dog Dude",
            "text": "Hey, have you reconsidered?",
            "replies": {
                "023": {
                    "text": "Yes, here you go",
                    "item": "SpecialFlower"
                },
                "022": {
                    "text": "I've already given it to Arnaldo",
                    "flag": "quest_flower_completed",
                    "no_flag": "dd_flower"
                },
                "015": {
                    "text": "Yes"
                },
                "019": {
                    "text": "No"
                },
                "008": {
                    "text": "Could I borrow that dog?",
                    "flag": "dd_mangy"
                },
                "branch_dog": {
                    "text": "Could I borrow Spritz?",
                    "no_flag": "dd_mangy"
                }
            }
        },
        "019": {
            "name": "Dog Dude",
            "text": "I'll be here if you change your mind."
        },
        "020": {
            "name": "Dog Dude",
            "text": "So, have you brought the flower?",
            "replies": {
                "024": {
                    "text": "Yes, here you go",
                    "item": "SpecialFlower"
                },
                "022": {
                    "text": "I've already given it to Arnaldo",
                    "flag": "quest_flower_completed",
                    "no_flag": "dd_flower"
                },
                "021": {
                    "text": "I don't have it yet"
                }
            }
        },
        "021": {
            "name": "Dog Dude",
            "text": "Spritz and I will be waiting!"
        },
        "022": {
            "name": "Dog Dude",
            "text": "That's a shame... At least Arnaldo is happy.",
            "set_flag": "quest_flower_dd_sad"
        },
        "023": {
            "name": "Dog Dude",
            "text": "Wow! I wasn't expecting that!",
            "next": "024"
        },
        "024": {
            "name": "Dog Dude",
            "text": "Thank you so much! If you need anything, I'll be here, friend.",
            "remove_item": "SpecialFlower",
            "set_flag": "dd_flower"
        },
        "025":{
            "text": "I don't think Arnaldo is ever going to forgive us, but at least you helped him...",
            "replies": {
                "008": {
                    "text": "Could I borrow that dog?",
                    "flag": "dd_mangy"
                },
                "branch_dog": {
                    "text": "Could I borrow Spritz?",
                    "no_flag": "dd_mangy"
                }
            }
        },
        "026": {
            "text": "I'm forever grateful. What do you need, friend?",
            "replies": {
                "008": {
                    "text": "Could I borrow that dog?",
                    "flag": "dd_mangy"
                },
                "027": {
                    "text": "Could I borrow Spritz?",
                    "no_flag": "dd_mangy"
                }
            }
        },
        "branch_dog": {
            "027": {
                "flag":"dd_flower"
            },
            "028": {
                "flag":"quest_flower_dd_sad"
            },
            "034": {}
        },
        "027": {
            "name": "Dog Dude",
            "text": "Of course, my friend! It's the least I can do after you helped me reconcile with Arnaldo!",
            "next": "030"
        },
        "028": {
            "name": "Dog Dude",
            "text": "You didn't help me, but you kept your word to Arnaldo and gave him the flower, which means you keep your word.",
            "next": "029"
        },
        "029": {
            "text": "Why do you need Spritz?",
            "replies": {
                "031": {
                    "text": "The Gravekeeper needs help getting truffles",
                    "flag": "gk_mention_truffle"
                },
                "branch_mangy": {
                    "text": "I just want a dog"
                },
                "end":{
                    "text":"Nevermind"
                }
            }
        },
        "030": {
            "name": "Dog Dude",
            "text": "Take care of Spritz and don't forget to bring him back when you're done. I don't know what I'd do without him!",
            "set_flag": "dd_borrow_dog",
            "reward": "Dog",
            "visibility": "Spritz"
        },
        "031": {
            "name": "Dog Dude",
            "text": "Dampere has a thing for truffles, so that's a legitimate reason!",
            "next": "030"
        },
        "branch_mangy": {
            "032": {
                "flag": "dd_mangy"
            },
            "033": {}
        },
        "032": {
            "name": "Dog Dude",
            "text": "You weren't fond of him before, and I doubt you changed your mind..."
        },
        "033": {
            "name": "Dog Dude",
            "text": "Dog's usually like treats, so you might be able to get YOUR OWN dog if you have some on you! Not Spritz, though, he already has an owner!"
        },
        "034": {
            "name": "Dog Dude",
            "text": "Sorry, I don't trust you enough to lend you my dear Spritz."
        },
        "035":{
            "name":"Dog Dude",
            "text": "Don't forget to return Spritz!",
            "replies": {
                "036": {
                    "text": "I don't need him anymore, here you go",
                    "item": "Dog"
                },
                "037": {
                    "text": "I still need him"
                }
            }
        },
        "036": {
            "name": "Dog Dude",
            "text": "Thank you. I hope he was able to help!",
            "set_flag": "dd_return_dog",
            "remove_item": "Dog",
            "visibility": "Spritz"
        },
        "037": {
            "name": "Dog Dude",
            "text": "No worries, just don't forget to bring him back!"
        },
        "038":{
            "name": "Dog Dude",
            "text": "Do you need Fritz's assistance again?",
            "replies": {
                "027": {
                    "text": "Actually, I do"
                },
                "end": {
                    "text": "Not really"
                }
            }
        }

        
    },
    "dog":{
        "start":{
            "002":{
                "flag":"dd_meet"
            },
            "001": {}
        },
        "001": {
            "name": "Dog",
            "text": "WOOF"
        },
        "002": {
            "name": "Spritz",
            "text": "WOOF WOOF"
        }
    },
    "grave":{
        "001": {
            "text": "The inscription reads: \"In Loving Memory of Josefa, the sweetest soul that ever lived\"",
            "next": "branch_dig"
        },
        "branch_dig": {
            "007": {
                "flag": "grave_dug"
            },
            "002": {
                "flag": "old_mention_necklace"
            },
            "end": {}

        },
        "002":{
            "text": "You remember the old man's mention of what you assume is a unique family pendant",
            "replies": {
                "003": {
                    "text": "Dig with your shovel",
                    "item": "Shovel"
                },
                "004": {
                    "text": "Have Spritz dig the grave",
                    "item": "Dog"
                },
                "005": {
                    "text": "Dig with your hands",
                    "no_flag": "grave_dig_hands"
                },
                "end": {
                    "text": "Don't disturb the grave"
                }
            }
        },
        "003": {
            "text": "You dig until you find Josefa's bones. You pry her pendant out of her neck.",
            "next": "006",
            "reward": "WifeHeirloom",
            "set_flag": "grave_dig_shovel"
        },
        "004": {
            "text": "Spritz happily digs, spraying earth everywhere, until he finds Josefa's bones. You pry her pendant out of her neck, while he happily chews on a bone.",
            "next": "006",
            "reward": "WifeHeirloom",
            "set_flag": "grave_dig_dog",
            "delayed_flag": "old_dd_mad"
        },
        "005": {
            "text": "You dig for a bit, until your nails hit earth that is no longer soft. You feel continuing without some sort of tool would be a waste of time.",
            "set_flag": "grave_dig_hands"
        },
        "006": {
            "text": "You get out of the grave with some effort, due to the hole's size",
            "set_flag": "grave_dug"
        },
        "007": {
            "text": "It's hard to miss the hole you dug and, from where you stand, you can see Josefa's skeleton, covered in her tattered dress."
        }
    },
    "machine": {
        "start": {
            "001": {}
        },
        "001": {
            "text": "Before you stands a vending machine. Unfortunately, it's a snack machine and therefore not the one you're looking for. "
        }
    }
}